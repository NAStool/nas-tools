runs-on: ubuntu-latest
steps:
  - uses: actions/checkout@v2
  - name: Release version
    id: release_version
    run: |
      app_version=$(cat version.py |sed -ne "s/APP_VERSION\s=\s'v\(.*\)'/\1/gp")
      echo "app_version=$app_version" >> $GITHUB_ENV
  - name: Create release
    id: create_release
    uses: actions/create-release@latest
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    with:
      tag_name: v${{ env.app_version }}
      release_name: v${{ env.app_version }}
      body: ${{ github.event.commits[0].message }}
      draft: false
      prerelease: false
  - name: output release_informations
    run: |
      echo "${{ steps.create_release.outputs.id }}" > release_id.txt
      echo "${{ env.app_version }}" > app_version.txt
  - name: save release_informations
    uses: actions/upload-artifact@v3
    with:
      name: release_informations
      path: |
        release_id.txt
        app_version.txt
